generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

 model User {
   id           Int       @id @default(autoincrement())
   email        String    @unique
   passwordHash String    @map("password_hash")
   name         String?
   createdAt    DateTime  @default(now()) @map("created_at")
   issues       Issue[]
   projects     Project[]
 }

 model Issue {
   id          Int         @id @default(autoincrement())
   user        User        @relation(fields: [userId], references: [id], onDelete: Cascade)
   userId      Int         @map("user_id")
   project     Project?    @relation(fields: [projectId], references: [id], onDelete: SetNull)
   projectId   Int?        @map("project_id")
   type        IssueType
   title       String
   description String      @db.Text
   priority    Priority    @default(MEDIUM)
   status      IssueStatus @default(OPEN)
   createdAt   DateTime    @default(now()) @map("created_at")
   updatedAt   DateTime    @updatedAt @map("updated_at")
 }

 model Project {
   id          Int           @id @default(autoincrement())
   user        User          @relation(fields: [userId], references: [id], onDelete: Cascade)
   userId      Int           @map("user_id")
   name        String
   description String        @db.Text
   clientName  String?       @map("client_name")
   status      ProjectStatus @default(ACTIVE)
   createdAt   DateTime      @default(now()) @map("created_at")
   updatedAt   DateTime      @updatedAt @map("updated_at")
   issues      Issue[]
 }

 enum ProjectStatus {
   ACTIVE
   COMPLETED
   ON_HOLD
   ARCHIVED
 }

 enum IssueType {
   CLOUD_SECURITY
   RETEAM_ASSESSMENT
   VAPT
 }

 enum Priority {
   LOW
   MEDIUM
   HIGH
   CRITICAL
 }

 enum IssueStatus {
   OPEN
   IN_PROGRESS
   RESOLVED
   CLOSED
 }
